# YOLO для распознавания показаний счетчиков воды

Проект обучения модели YOLO для распознвания показаний счетчиков воды. На вход модель принимает фотографию счетчика, на выходе выдает фотографию с размеченными панелью и цифрами показаний. На консоль выводится результат работы модели в формате JSON. Пример вывода:

```
{'image_name': 'id_910_value_550_348.jpg', 'value': '00550348'}
```

В примере:
* `image_name` -- в названии прописаны `id` и истинные показания `550_348`
* `value` -- предсказания модели `00550348`

Модель возвращает "сырые" данные, которые подлежат соотвествующей обработки (конкретная реализация зависит от дальнейшего развития проекта).

## Набор данных

Датасет был собран энтузиастами и выложен на Kaggle. К бесплатному использованию доступны 1244 изображения. Полный датасет автор продает на своем сайте (ссылка есть на Kaggle). Данные были собраны при помощи сервиса Яндекс.Толока по строгим требованиям касательно качества изображений. Автор датасета разметил только панели показаний, поэтому для использования в проекте разметка цифр была проведена отдельно с помощью Label Studio. 

Ссылка Kaggle: https://www.kaggle.com/datasets/tapakah68/yandextoloka-water-meters-dataset

## Модели

На основании датасета были обучены 2 модели:
* `panels_base` -- модель для определения панели показаний
* `digits_base` -- модель для определения цифр показаний

Обе модели являются базовыми, поскольку 1.2к изображений для решения задачи на уровне выкатывания в продакшен явно недостаточно. Тем не менее, на имеющихся данных модель определения панелей показывает точность 96%, модель определения цифр 92%. Улучшить эти показатели можно путем расширения датасета.

### Отчет по модели определения цифр:
    Class     Images  Instances  Precision     Recall      mAP50   mAP50-95
      all        186       1469      0.912      0.847      0.936      0.556
        0        186        523      0.988      0.956      0.988      0.602
        1        114        142      0.942      0.901      0.973      0.543
        2         96        122      0.907      0.918      0.967       0.62
        3         84        107      0.838      0.879       0.94      0.562
        4         74         92      0.879      0.788      0.898      0.526
        5         79         99      0.914      0.863      0.944      0.553
        6         88        106      0.957      0.836      0.918       0.57
        7         79         95       0.93      0.836       0.93      0.524
        8         78         97      0.865      0.753      0.899      0.531
        9         74         86      0.898      0.744      0.901      0.525

### Ограничения

На данный момент в виду того, что проект является демо, при работе с моделью нужно помнить об ограничениях:

1. **Фото должны быть четкими**. Чтобы модель распознала показания, используйте фото с хорошими яркостью и контрастностью.
2. **Панель должна быть по горизонту**. Имеется в виду, что не нужно фотографировать счетчик криво. Чем больше уклон, тем сложнее модели понять цифры.
3. **Счетчики должны быть российскими**. Модель обучалась на российских счетчиках и зарубежные может не понять.

## Как пользоваться

Используйте `main.py`, в константе `IMAGES_PATH` укажите путь к вашим изображениям. Модель отработает и сохранит результат в директорию `results` внутри вашей директории с изображениями. На консоль будет выведена информация по распознанным показаниям. Пример можно посмотреть в директории `data/images`.
